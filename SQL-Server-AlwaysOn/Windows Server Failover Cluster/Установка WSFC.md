# Установка отказоустойчивого кластера Windows

Доступно несколько вариантов установки компонентов отказоустойчивого кластера Windows, из которых два осоновных это:

- Используя "Диспетчер серверов"
- И через PowerShell

Пробежимся по обоим вариантам.

## Установка из диспетчера серверов

Для начала, необходимо добавить компоненты кластера на машину с Windows Server через "Диспетчер серверов".

![Добавление компонентов кластера](media/1.%20%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%20WSFC/1.%20%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D0%BE%D0%B2.PNG)

Перед нами появится мастер добавления ролей и компонентов.

![Мастер добавления ролей и компонентов](media/1.%20Установка%20WSFC/2.%20Начало%20работы%20мастера.PNG)

В нашем случае выбираем "Установка ролей и компонентов", т.к. все настройки выполняем на текущем сервере.

![Выбор типа установки](media/1.%20Установка%20WSFC/3.%20Выбор%20типа%20установки.PNG)

Далее на шаге выбора целевого сервера оставляем все как есть.

![Выбор целевого сервера](media/1.%20Установка%20WSFC/4.%20Выбор%20целевого%20сервера.PNG)

После этого оказываемся на этапе выбора ролей сервера. В нашем примере здесь также ничего менять не нужно.

![Выбор ролей](media/1.%20Установка%20WSFC/5.%20Выбор%20ролей%20сервера.PNG)

А вот на следующем этапе выбора компонентов необходимо указать установку для "Отказоустойчивая кластеризация".

![Выбор компонентов](media/1.%20Установка%20WSFC/6.%20Выбор%20компонентов.PNG)

А после подтвердить установку связанных компонентов. Кстати, устанавливать средства управления кластером на каждый узел нет необходимости, можно это сделать только там, откуда планируется кластером управлять.

![Подтверждение установки компонентов](media/1.%20Установка%20WSFC/7.%20Установка%20связанных%20компонентов.PNG)

Мы в одном шаге от начала установки. Если все правильно, то подтверждаем изменения.

![Подтверждение изменения](media/1.%20Установка%20WSFC/8.%20Подтверждение%20изменений.PNG)

Ждем некоторое время, пока процесс установки не будет завершен.

![Процесс установки](media/1.%20Установка%20WSFC/9.%20Применение%20изменений.PNG)

... и получаем установленные компоненты кластеризации на сервере. При желании предопределенную конфигурацию установки кластера можно сохранить в файл и после использовать для развертывания на других серверах.

```PowerShell
# Параметр "ConfigurationFilePath" определяем путь к файлу 
# конфигурации развертывания, который мы сохранили по завершению
# установки компонентов кластера
Install-WindowsFeature -ComputerName $s -ConfigurationFilePath $f
```

![Завершение установки](media/1.%20Установка%20WSFC/10.%20Установка%20завершена.PNG)

После выполненных изменений необходимо перезапустить сервер.

![Необходим перезапуск](media/1.%20Установка%20WSFC/11.%20Необходим%20перезапуск.PNG)

## Установка с помощью PowerShell

Установка отказоустойчивого кластера с помощью средств PowerShell выполняется куда проще, чем через интерфейс.

```PowerShell
Install-WindowsFeature -Name Failover-Clustering -IncludeAllSubFeature
```

Если есть необходимость, то также можно установить средства управления кластером.

```PowerShell
Install-WindowsFeature -Name RSAT-Clustering -IncludeAllSubFeature
```

Процесс установки обоих компонентов будет следующим:

1. Запускаем команду.

![Запускаем команду установки кластера](media/1.%20Установка%20WSFC/PowerShell/0.%20PS.%20Команда%20установки.PNG)

2. Ждем.

![Ждем завершение установки кластера](media/1.%20Установка%20WSFC/PowerShell/1.%20PS.%20Процесс%20установки.PNG)

3. Радуемся.

![Установка кластера завершена](media/1.%20Установка%20WSFC/PowerShell/2.%20PS.%20Установка%20завершена.PNG)

Тоже самое и для компоненты управления кластером.

1. Раз.

![Запускаем команду установки кластера](media/1.%20Установка%20WSFC/PowerShell/3.%20PS.%20Установка%20средств%20управления%20кластером.PNG)

2. Два.

![Ждем завершение установки кластера](media/1.%20Установка%20WSFC/PowerShell/4.%20PS.%20Процесс%20установки%20средств%20управления%20кластером.PNG)

3. Три.

![Установка кластера завершена](media/1.%20Установка%20WSFC/PowerShell/5.%20PS.%20Установка%20средств%20управления%20завершена.PNG)

Все готово!